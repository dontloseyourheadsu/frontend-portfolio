<nav class="nav-bar">
  <button
    (click)="toggleHidden()"
    aria-label="Toggle Navigation"
    type="button"
    class="nav-toggle"
  >
    <span class="material-icons">{{
      hidden ? "keyboard_arrow_right" : "keyboard_arrow_left"
    }}</span>
  </button>
  <button
    class="theme-toggle"
    (click)="switchTheme()"
    aria-label="Toggle Theme"
    type="button"
  >
    <span class="material-icons">{{
      theme === Themes.LIGHT ? "light_mode" : "dark_mode"
    }}</span>
  </button>

  <hr class="list-separator" />

  <!-- Single flat list with animated background -->
  <div class="list-container">
    <div class="list-indent"></div>
    <ul class="nav-links" #navList>
      <div class="nav-background" #navBg></div>
      @for (item of visibleItems; track item.name) {
      <li class="nav-item inter-regular" (click)="onNavClick($event)">
        <div class="nav-row">
          <!-- indentation spans (0.25rem each) placed inside row so they sit to the left -->
          @for (_ of indentArray(item.depth); track _) {
          <span class="indent"></span>
          }
  
          <!-- link or text -->
          @if (item.link) {
          <a
            class="nav-link"
            [routerLink]="item.link"
            routerLinkActive="active"
            [routerLinkActiveOptions]="{ exact: true }"
          >
            {{ item.name }}
          </a>
          } @else {
          <span
            class="nav-link nav-link-text"
            (click)="toggleParentByIndex(item.parentIndex)"
          >
            {{ item.name }}
          </span>
          }
  
          <!-- parent toggler if parent and has children (to the right of text) -->
          @if (item.isParent) {
          <span
            class="toggle-span material-icons"
            (click)="
              toggleParentByIndex(item.parentIndex); $event.stopPropagation()
            "
            [attr.aria-expanded]="item.expanded"
            [attr.aria-label]="'Toggle ' + item.name + ' group'"
          >
            {{ item.expanded ? "keyboard_arrow_up" : "keyboard_arrow_down" }}
          </span>
          }
        </div>
      </li>
      }
    </ul>
  </div>
</nav>
